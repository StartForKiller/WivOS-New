Triying to refactor my operating system code.